[gd_scene load_steps=11 format=2]

[ext_resource path="res://Assets/Textures/TexturesCom_MetalFloorsBare0063_2_seamless_S.jpg" type="Texture" id=1]
[ext_resource path="res://Assets/Models/Cars/Caterham/Car.tscn" type="PackedScene" id=2]
[ext_resource path="res://Assets/Textures/TexturesCom_Roads0069_1_seamless_S.jpg" type="Texture" id=3]
[ext_resource path="res://Scripts/camera.gd" type="Script" id=4]

[sub_resource type="PlaneShape" id=1]

[sub_resource type="SpatialMaterial" id=2]
albedo_texture = ExtResource( 1 )
uv1_scale = Vector3( 500, 500, 500 )

[sub_resource type="PlaneMesh" id=3]
material = SubResource( 2 )
size = Vector2( 1000, 1000 )
subdivide_width = 10
subdivide_depth = 10

[sub_resource type="Curve3D" id=4]
_data = {
"points": PoolVector3Array( 4.57024, 0, 4.87492, -4.57024, 0, -4.87492, -21.2745, 0, -0.728703, 0.0154457, 0, 7.72682, -0.0154457, 0, -7.72682, -30.4818, 0, -19.9273, -16.1776, -0.119751, 3.18003, 16.1776, 0.119751, -3.18003, -10.3329, 0, -40.0032, -4.98759, 3.53308, -21.4945, 4.98759, -3.53308, 21.4945, 24.524, 0.64563, -43.9543, -5.60938, 0.910767, -10.3932, 5.60938, -0.910767, 10.3932, 49.1036, -0.0130615, -31.3283, -5.17264, 0.200928, -16.5715, 5.17264, -0.200928, 16.5715, 38.2164, 0.96814, 2.43683, 3.02074, 4.4458, -13.5045, -3.02074, -4.4458, 13.5045, 15.3239, -0.00012207, 25.1867, 1.59921, 0, -15.6368, -1.59921, 0, 15.6368, 25.4838, -0.00012207, 55.9843, 17.5914, 0, 8.35149, -17.5914, 0, -8.35149, -29.4228, 5.40417, 46.5667, -4.51157, 0, 19.7381, 4.51157, 0, -19.7381, -74.3195, 0, 34.4115, -3.38367, 0, 15.2266, 3.38367, 0, -15.2266, -81.3688, 0, -8.7304, -11.8426, -0.0997314, -1.6808, 11.8426, 0.0997314, 1.6808, -55.7092, 0, -27.3406, 2.53971, 1.40662, -13.1811, -2.53971, -1.40662, 13.1811, -43.0204, 0, -0.553173, -17.8843, 1.23499, -5.84414, 17.8843, -1.23499, 5.84414, -39.6368, 0, 28.2081, -3.83305, 0, 6.46025, 3.83305, 0, -6.46025, -9.7476, 0, 21.1588, 0, 0, 0, 0, 0, 0, -21.5791, 0, -1.03339 ),
"tilts": PoolRealArray( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 )
}

[sub_resource type="Shader" id=5]
code = "shader_type spatial;

uniform sampler2D road_texture;

void fragment() {
	vec2 road_uv = vec2(UV.y, UV.x);
	
	vec4 color = texture(road_texture, road_uv);
	ALBEDO = color.rgb;
	METALLIC = 0.0;
	ROUGHNESS = 0.0;
}"

[sub_resource type="ShaderMaterial" id=6]
shader = SubResource( 5 )
shader_param/road_texture = ExtResource( 3 )

[node name="Second-Level" type="Spatial"]

[node name="Ground" type="StaticBody" parent="."]

[node name="CollisionShape" type="CollisionShape" parent="Ground"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Ground"]
mesh = SubResource( 3 )
material/0 = null

[node name="MeshInstance2" type="MeshInstance" parent="Ground"]
mesh = SubResource( 3 )
material/0 = null

[node name="Sun" type="DirectionalLight" parent="."]
transform = Transform( 1, 0, 0, 0, -0.843401, 0.537285, 0, -0.537285, -0.843401, 0, 7.81737, 0 )
shadow_enabled = true

[node name="Car" type="Spatial" parent="."]
transform = Transform( 0.883578, 0, 0.468285, 0, 1, 0, -0.468285, 0, 0.883578, -22.5176, 1.88086, 0 )

[node name="Car" parent="Car" instance=ExtResource( 2 )]

[node name="Camera" type="Camera" parent="."]
transform = Transform( -1, 0, -3.25841e-07, 0, 1, 0, 3.25841e-07, 0, -1, 0.42428, 4.33854, -8.96471 )
script = ExtResource( 4 )
follow_this_path = NodePath("../Car/Car")

[node name="Circuit" type="Spatial" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.925537, 0 )

[node name="Path" type="Path" parent="Circuit"]
curve = SubResource( 4 )

[node name="Road" type="CSGPolygon" parent="Circuit/Path"]
invert_faces = true
polygon = PoolVector2Array( -4, 0, -4, 0.1, 4, 0.1, 4, 0 )
mode = 2
path_node = NodePath("..")
path_interval = 1.0
path_rotation = 2
path_local = false
path_continuous_u = false
path_joined = false
material = SubResource( 6 )

[node name="CollisionShape" type="CSGPolygon" parent="Circuit/Path"]
visible = false
use_collision = true
invert_faces = true
polygon = PoolVector2Array( -4, 0, 4, 0, 4, 2, 8, 2, 8, -1, -8, -1, -8, 2, -4, 2 )
mode = 2
path_node = NodePath("..")
path_interval = 1.0
path_rotation = 2
path_local = false
path_continuous_u = false
path_joined = false
